@F enclave/flow_parser.py opus 2026-01-10
Summary:
  What: Flow format parser and validator
  Purpose: Parse indent-based semantic memory format

Flow Format:
  Anchor: @F topic agent date
  Indent: 2 spaces = nesting level
  Headers: Name followed by colon
  References: ~line for locations | @ref() for cross-links

Key Classes:
  FlowNode: content, indent_level, line_number, root, pivot
  FlowDocument: topic, agent, date, nodes, raw_text

Key Functions:
  FlowParser.parse(text, creator) -> FlowDocument
  FlowParser.validate(doc) -> (is_valid, errors)
  parse_flow(text, creator) -> convenience wrapper
  is_flow_format(text) -> bool | checks @F prefix

Embedding Strategy:
  Root-Pivot-Leaf | Root = level 1 | Pivot = parent | Leaf = content
  Captures hierarchy context for semantic search

Design: Flow is water not concrete | parses intent not syntax
